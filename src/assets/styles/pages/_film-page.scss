// =========================================
// FILM ページ専用スタイル
// ルートクラス .film-page 配下に100%スコープ
// 既存の service-page / company / top は未変更
// =========================================
@use "../variables" as v;
@use "../mixins" as m;

$film-border: #e0e0e0;
$film-accent: #0066cc;
$film-text: v.$color-text;
$film-muted: rgba(0, 0, 0, 0.6);

.film-page {
  position: relative;
  overflow: hidden;

  .service-page__bg {
    position: absolute;
    inset: 0;
    z-index: -1;
    pointer-events: none;

    background-image:
      url("/img/background/background-bom01.png"),
      url("/img/background/background-bom01-flip.png"),
      url("/img/background/mist01.webp"),
      url("/img/background/background-bom01.png"),
      url("/img/background/mist04.webp"),
      url("/img/background/background-bom01-flip.png");

    background-repeat: no-repeat;

    background-position:
      100% 3%,
      0% 26%,
      20% 40%,
      100% 75%,
      50% 89%,
      -30% 98%;

    background-size: 80vw, 50vw, 70vw, 80vw, 40vw, 65vw;
  }

  .film-page > *:not(.service-page__bg) {
    position: relative;
    z-index: 1;
  }

  @media (max-width: 768px) {
    .service-page__bg {
      background-position:
        100% 9%,
        0% 32%,
        30% 44%,
        110% 78.5%,
        50% 85%,
        0% 93.5%;

      background-size: 130vw, 100vw, 120vw, 120vw, 120vw, 120vw;
    }
  }

  /* =========================================
     introduction
  ========================================== */
  .film-work-concept {
    margin-top: 40px;
  }

  .film-work-concept__inner {
    max-width: 960px;
    margin: 0 auto;
    padding: clamp(32px, 6vw, 56px);
    text-align: center;
    background-color: rgb(255, 255, 255, 0.5);

    @media (max-width: 768px) {
      padding: 20px;
    }
  }

  .film-work-concept__text {
    margin: 0;
    font-size: 1rem;
    line-height: 2;
    color: rgba(0, 0, 0);

    @media (max-width: 768px) {
      text-align: left;
    }
  }

  /* =========================================
     Works（映像参考）
  ========================================== */
  .film-works {
    padding-top: clamp(3rem, 8vw, 5rem);
    padding-bottom: clamp(3rem, 8vw, 5rem);
  }

  .film-works__en {
    margin: 0 0 0.5rem;
    font-size: clamp(1.75rem, 3.5vw, 2.5rem);
    font-weight: 700;
    color: $film-accent;
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  .film-works__sub {
    margin: 0 0 clamp(2rem, 5vw, 3rem);
    font-size: 0.9375rem;
    color: $film-muted;
  }

  /* =========================================
     Worries
  ========================================== */
  .film-worries {
    padding-top: clamp(3rem, 8vw, 5rem);
    padding-bottom: clamp(3rem, 8vw, 5rem);
  }

  .film-worries__title {
    width: 380px;
    margin: 0 auto clamp(2rem, 5vw, 3rem);
    padding: 15px 20px;
    font-size: clamp(1.25rem, 3vw, 1.5rem);
    font-weight: 700;
    color: $film-text;
    text-align: center;
    background: url("/img/sub-page/sub-title-image.jpg") no-repeat center
      center / cover;
    display: block;
  }

  .film-worries__grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: clamp(1.25rem, 3vw, 2rem);
    list-style: none;
    margin: 0 0 clamp(2.5rem, 6vw, 3.5rem);
    padding: 0;
    position: relative;

    @media (max-width: 767px) {
      grid-template-columns: 1fr;
    }

    &::before {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80%;
      height: 1px;
      background: #838383;

      @media (max-width: 768px) {
        display: none;
      }
    }

    &::after {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 1px;
      height: 100%;
      background: #838383;

      @media (max-width: 768px) {
        display: none;
      }
    }
  }

  .film-worry-card {
    padding: clamp(1.5rem, 4vw, 2rem);
    text-align: center;
  }

  .film-worry-card__icon {
    margin-bottom: 1rem;

    img {
      display: block;
      margin: 0 auto;
      object-fit: contain;
    }
  }

  .film-worry-card__text {
    margin: 0;
    margin-top: 1.5rem;

    padding: 1.2em 1.6em;
    text-align: center;

    font-size: clamp(0.875rem, 1.5vw, 1rem);
    font-weight: 500;
    line-height: 1.5;
    color: $film-text;

    background: #f0f0f0; // 薄いグレー
    border-radius: 20px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.06);

    display: inline-block;
  }

  .film-worries__arrow-wrap {
    text-align: center;
  }

  .film-worries__arrow {
    position: relative;
    display: inline-block;
    width: 250px;
    height: 80px;

    &::before {
      content: "";
      position: absolute;
      inset: 0;
      background: url("/img/icons/polygon01.webp") no-repeat center center /
        contain;
    }
  }

  .film-worries__conclusion {
    margin: 0;
    font-size: 1.2rem;
    color: #000;
    font-weight: 700;
  }

  /* =========================================
     PR VIDEO CAN BE USED FOR（活用シーン）
  ========================================== */
  .film-uses {
    padding-top: clamp(3rem, 8vw, 5rem);
    padding-bottom: clamp(3rem, 8vw, 5rem);
  }

  .film-uses__en {
    margin: 0 0 0.5rem;
    font-size: clamp(1.25rem, 2.5vw, 1.75rem);
    font-weight: 700;
    color: $film-accent;
    letter-spacing: 0.06em;
    text-transform: uppercase;
  }

  .film-uses__sub {
    margin: 0 0 clamp(2rem, 5vw, 3rem);
    font-size: 0.9375rem;
    color: $film-muted;
  }

  .film-uses__lead {
    margin: 4rem auto 3rem;
    font-size: 1.3rem;
    font-weight: 700;
    color: $film-text;
    text-align: center;
    width: fit-content;
    padding: 1rem 1.5rem;
    background-color: rgb(255, 255, 255, 0.5);
  }

  .film-uses__grid {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    column-gap: clamp(22px, 3vw, 34px); // 横
    row-gap: clamp(40px, 6vw, 64px);
    justify-items: center;
    list-style: none;
    padding: 0;
    margin: 0 0 clamp(24px, 5vw, 40px);

    @media (max-width: 900px) {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    @media (max-width: 520px) {
      grid-template-columns: repeat(2, minmax(0, 1fr));
      row-gap: clamp(28px, 6vw, 40px);
    }
  }

  .film-use-card {
    width: min(180px, 100%);
    text-align: center;
  }

  .film-use-card__icon {
    position: relative;
    width: 80%;
    aspect-ratio: 1 / 1;
    margin: 0 auto 12px;
    border: 5px solid #1265d2; // スクショの青枠寄せ
    overflow: hidden;
    display: grid;
    place-items: center;
    background: rgba(26, 92, 255, 0.06);

    /* 薄い写真っぽい背景（不要なら丸ごと消してOK） */
    &::before {
      content: "";
      position: absolute;
      inset: 0;
      background-image: var(--bg);
      background-size: cover;
      background-position: center;
      opacity: 0.5;
      transform: scale(1.02);
    }

    img {
      position: relative;
      z-index: 1;
      width: 70px;
      height: auto;
      display: block;
      object-fit: contain;

      &.large {
        width: 100px;
      }
    }
  }

  .film-use-card__text {
    margin: 0;
    font-size: 1.25rem;
    font-weight: 500;
    color: rgba(0, 0, 0, 0.78);
    letter-spacing: 0.03em;
    white-space: nowrap;

    @media (max-width: 768px) {
      font-size: 1rem;
    }
  }

  .film-uses__note {
    max-width: 720px;
    margin: 0 auto;
    padding: 1.25rem 1.5rem;
    background: url("/img/sub-page/sub-page-background.webp") center / 200px
      200px repeat;
    border: 1px solid $film-border;

    p {
      margin: 0;
      font-size: 1.2rem;
      line-height: 1.7;
      color: #000;
      text-align: center;
      font-weight: 500;
    }
  }

  /* =========================================
     Message
  ========================================== */
  .film-message {
    padding-top: clamp(3rem, 8vw, 5rem);
    padding-bottom: clamp(2rem, 5vw, 3rem);
    text-align: center;
  }

  .film-message__text {
    width: fit-content;
    margin: 30px auto 0;
    font-size: 1.2rem;
    line-height: 2;
    color: $film-text;
    background-color: rgb(255, 255, 255, 0.5);
    padding: 1rem 1.5rem;

    @media (max-width: 768px) {
      text-align: left;
      padding: 0;
      font-size: 1rem;
      margin-top: 0;
    }
  }
}

/* =========================================
  フッター内 to top（Filmページ用）
  ※フッターは .film-page 外のためルートで定義
========================================= */
.film-page-to-top {
  position: absolute;
  top: 0;
  right: 0;
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  gap: 0.35rem;
  padding-top: 0.5rem;
  color: rgba(255, 255, 255, 0.6);
  text-decoration: none;
  font-size: 0.7rem;
  letter-spacing: 0.12em;
  transition: color 0.25s ease;

  &:hover {
    color: rgba(255, 255, 255, 0.9);
  }

  @media (max-width: 767px) {
    position: static;
    margin-left: auto;
    margin-top: 0.5rem;
  }
}

.film-page-to-top__icon {
  width: 14px;
  height: 14px;
  border-right: 2px solid currentColor;
  border-top: 2px solid currentColor;
  transform: rotate(-45deg);
}

.film-page-to-top__text {
  text-transform: lowercase;
}

/* Filmページのフッター：to top 用に relative */
body:has(.film-page) .site-footer__inner,
.site-footer__inner:has(.film-page-to-top) {
  position: relative;
  padding-top: 2.5rem;
}

/* Filmページ：PC時のみヘッダーメニューを黒系に（薄い背景のため） */
@include m.mq(md) {
  body.page-film .global-header .global-nav__link {
    color: $film-text;
    &::after {
      background: $film-text;
    }
  }
  body.page-film .global-header.is-scrolled .global-nav__link::after {
    background: $film-text;
  }
}

/* =========================================
   Film Hero（下層ページ共通・背景画像は section の inline style で指定）
========================================== */
.film-hero {
  position: relative;
  min-height: clamp(200px, 40vw, 320px);
  display: flex;
  align-items: center;
  justify-content: flex-start;
  overflow: hidden;
  padding-top: calc(65px + clamp(1.5rem, 4vw, 2.5rem));
  padding-bottom: clamp(2rem, 5vw, 3rem);

  background-color: #f8f6f3;
  background-position: center;
  background-size: cover;
  background-repeat: no-repeat;

  @include m.mq(md) {
    min-height: clamp(280px, 35vw, 380px);
  }
}

.film-hero__bg {
  position: absolute;
  inset: 0;
  z-index: 0;
  pointer-events: none;

  background: rgba(255, 255, 255, 0.35);
}

.film-hero .container {
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  align-items: flex-start;

  @media (max-width: 768px) {
    padding-left: 5.5rem;
  }
}

.film-hero__title {
  margin: 0 0 clamp(0.5rem, 1.5vw, 1rem);
  font-size: 3.5rem;
  font-weight: 700;
  color: $film-text;
  letter-spacing: 0.02em;
  line-height: 1.1;

  @media (max-width: 768px) {
    font-size: 1.9rem;
  }
}

.film-hero__lead {
  margin: 0;
  font-size: clamp(0.9rem, 2vw, 1.05rem);
  font-weight: 400;
  color: #000;
  line-height: 1.7;
  letter-spacing: 0.02em;
}

.film-hero__title {
  position: relative;
  display: inline-block;
  line-height: 1.4;

  /* 角度を共通化 */
  --slant-angle: -25deg;
  --bg: rgba(255, 255, 255, 0.9);
  --pad-x: 1.3em;
  --pad-y: 0.15em;
  --shift-x: -0.4em; /* ★左にずらす量 */

  &::before {
    content: "";
    position: absolute;
    top: calc(-1 * var(--pad-y));
    bottom: calc(-1 * var(--pad-y));
    left: calc(-1 * var(--pad-x));
    right: calc(-1 * var(--pad-x));
    background: var(--bg);
    z-index: -1;

    /* ★位置 → 角度 の順で指定 */
    transform: translateX(var(--shift-x)) skewX(var(--slant-angle));
    transform-origin: center;
  }
}

.film-hero__lead {
  position: relative;
  display: inline-block;
  line-height: 1.4;
  color: #fff;

  /* 角度を共通化 */
  --slant-angle: -25deg;
  --bg: rgba(18,101,210,0.9);
  --pad-x: 2em;
  --pad-y: 0.5em;
  --shift-x: -0.4em;

  &::before {
    content: "";
    position: absolute;
    top: calc(-1 * var(--pad-y));
    bottom: calc(-1 * var(--pad-y));
    left: calc(-1 * var(--pad-x));
    right: calc(-1 * var(--pad-x));
    background: var(--bg);
    z-index: -1;

    /* ★位置 → 角度 の順で指定 */
    transform: translateX(var(--shift-x)) skewX(var(--slant-angle));
    transform-origin: center;
  }
}

/* 斜めの四角3つ */
.film-hero__mark {
  --w: 18px;          /* 1本の幅 */
  --h: 64px;          /* 1本の高さ */
  --skew: -25deg;     /* 斜め角度 */
  --gap: 8px;         /* 3本の間隔 */

  position: relative;
  width: calc(var(--w) * 3 + var(--gap) * 2);
  height: var(--h);
  flex: 0 0 auto;
}

@media (max-width: 480px) {
  .film-hero__mark {
    --w: 12px;  /* 横幅だけ細く */
  }
}

/* 1本目（濃い青） */
.film-hero__mark::before,
.film-hero__mark::after {
  content: "";
  position: absolute;
  top: 0;
  bottom: 0;
  width: var(--w);
  transform: skewX(var(--skew));
  border-radius: 1px; // ほんの少し角を丸めたい場合
}

/* 1本目 */
.film-hero__mark::before {
  left: -6rem;
  background: #35c8ff;
  top: -1rem;
  bottom: -1rem;

  @media (max-width: 480px) {
    left: -4.4rem;
    bottom: -0.5rem;
    top: -0.5rem;
  }
}

/* 3本目（薄い水色） */
.film-hero__mark::after {
  left: -1.25rem;
  background: #35c8ff;
  bottom: 0.5rem;
  top: -2.5rem;

  @media (max-width: 480px) {
    left: -0.8rem;
    top: -1.8rem;
  }
}

/* 2本目（真ん中）だけは span の中にもう1個作るのが確実 */
.film-hero__mark {
  & > i {
    position: absolute;
    top: -0.5em;
    bottom: -0.5em;
    left: -5rem;
    width: calc(var(--w) * 2);
    transform: skewX(var(--skew));
    background: #1C4D8D;
    border-radius: 1px;
    content: "";

    @media (max-width: 480px) {
      left: -3.6rem;
    }
  }
}

@keyframes heroTextIn {
  from {
    margin-left: 30px;   /* 左から */
    opacity: 0;
  }
  to {
    margin-left: 0;
    opacity: 1;
  }
}

.film-hero__title,
.film-hero__lead {
  opacity: 0; /* 初期非表示 */
  animation: heroTextIn 700ms ease-out forwards;
}

.film-hero__lead {
  animation-delay: 120ms; /* タイトルのあと */
}

@keyframes markDropIn {
  from {
    transform: translateY(-48px) skewX(var(--skew)); /* ★大きく上から */
    opacity: 0;
  }
  to {
    transform: translateY(0) skewX(var(--skew));
    opacity: 1;
  }
}

.film-hero__mark::before,
.film-hero__mark > i,
.film-hero__mark::after {
  opacity: 0;
  animation: markDropIn 700ms cubic-bezier(.16, 1, .3, 1) forwards;
}

/* 時間差を広げる */
.film-hero__mark::before { animation-delay: 120ms; }
.film-hero__mark > i     { animation-delay: 260ms; }
.film-hero__mark::after  { animation-delay: 400ms; }
